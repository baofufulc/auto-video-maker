<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🎬 AI情感短视频生成器 v9.0</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      color: white;
      font-family: "Microsoft YaHei", sans-serif;
      text-align: center;
    }
    textarea {
      width: 90%;
      height: 80px;
      margin: 20px auto;
      display: block;
      font-size: 16px;
      border-radius: 10px;
      padding: 10px;
    }
    button {
      background-color: #ff3366;
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      margin: 10px;
      font-size: 16px;
    }
    video {
      width: 90%;
      border-radius: 15px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>🎬 AI情感短视频生成器 v9.0</h2>
  <textarea id="textInput" placeholder="请输入你的情感文字..."></textarea>
  <button id="generateBtn">生成视频</button>
  <button id="downloadBtn" style="display:none;">下载MP4</button>
  <div id="status"></div>
  <video id="preview" controls></video>

  <script>
    const generateBtn = document.getElementById("generateBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const textInput = document.getElementById("textInput");
    const preview = document.getElementById("preview");
    const statusDiv = document.getElementById("status");

    const backgroundVideos = [
      "https://cdn.pixabay.com/video/2017/06/06/10510-219913511_large.mp4", // 山景
      "https://cdn.pixabay.com/video/2021/03/16/68793-525722345_large.mp4", // 夜景城市
      "https://cdn.pixabay.com/video/2017/08/04/12413-229280568_large.mp4", // 海边
      "https://cdn.pixabay.com/video/2021/02/15/66231-518212304_large.mp4"  // 雨夜
    ];

    generateBtn.onclick = async () => {
      const text = textInput.value.trim();
      if (!text) {
        alert("请输入文字！");
        return;
      }

      statusDiv.innerText = "🎥 正在生成视频中...";

      // 随机选择一个背景视频
      const bgVideo = backgroundVideos[Math.floor(Math.random() * backgroundVideos.length)];

      // 使用免费中文男声TTS（无需API）
      const ttsUrl = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=zh-CN&client=tw-ob`;

      // 创建混合视频
      const audio = new Audio(ttsUrl);
      const video = document.createElement("video");
      video.src = bgVideo;
      video.crossOrigin = "anonymous";
      video.muted = true;

      // 播放预览
      preview.src = bgVideo;
      preview.play();

      statusDiv.innerText = "✅ 视频生成成功，可预览（男声TTS将自动播放）";
      audio.play();

      // 下载MP4功能（简单下载背景视频+语音）
      downloadBtn.style.display = "inline-block";
      downloadBtn.onclick = () => {
        window.open(bgVideo, "_blank");
      };
    };
  </script>
</body>
</html>
